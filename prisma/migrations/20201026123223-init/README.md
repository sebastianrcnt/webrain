# Migration `20201026123223-init`

This migration has been generated by sebastianrcnt at 10/26/2020, 9:32:24 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;

CREATE TABLE "Experiment" (
"id" TEXT NOT NULL DEFAULT 'unset',
"userEmail" TEXT ,
"name" TEXT NOT NULL DEFAULT 'unset',
"description" TEXT ,
"fileId" TEXT NOT NULL DEFAULT 'unset',
"fileName" TEXT ,
"json" TEXT  DEFAULT '{}',
"tags" TEXT ,
"coverFileId" TEXT ,
PRIMARY KEY ("id"),
FOREIGN KEY ("userEmail") REFERENCES "User"("email") ON DELETE SET NULL ON UPDATE CASCADE
)

CREATE TABLE "User" (
"email" TEXT NOT NULL DEFAULT 'unset@monet.com',
"name" TEXT NOT NULL DEFAULT 'unset',
"phone" TEXT ,
"password" TEXT  DEFAULT 'unset',
"level" INTEGER NOT NULL DEFAULT 0,
PRIMARY KEY ("email"))

CREATE TABLE "Project" (
"id" TEXT NOT NULL DEFAULT 'unset',
"description" TEXT ,
"agreement" TEXT ,
"public" INTEGER NOT NULL DEFAULT 0,
"userEmail" TEXT ,
"unitProjectId" TEXT ,
"name" TEXT ,
"coverFileId" TEXT ,
PRIMARY KEY ("id"),
FOREIGN KEY ("userEmail") REFERENCES "User"("email") ON DELETE SET NULL ON UPDATE CASCADE,

FOREIGN KEY ("unitProjectId") REFERENCES "UnitProject"("id") ON DELETE SET NULL ON UPDATE CASCADE
)

CREATE TABLE "Result" (
"experimentId" TEXT ,
"projectId" TEXT ,
"timestamp" TEXT ,
"id" TEXT NOT NULL DEFAULT 'unset',
"done" INTEGER NOT NULL DEFAULT 0,
"userEmail" TEXT ,
"json" TEXT  DEFAULT '{}',
PRIMARY KEY ("id"),
FOREIGN KEY ("experimentId") REFERENCES "Experiment"("id") ON DELETE SET NULL ON UPDATE CASCADE,

FOREIGN KEY ("projectId") REFERENCES "Project"("id") ON DELETE SET NULL ON UPDATE CASCADE,

FOREIGN KEY ("userEmail") REFERENCES "User"("email") ON DELETE SET NULL ON UPDATE CASCADE
)

CREATE TABLE "UnitProject" (
"id" TEXT NOT NULL DEFAULT 'unset',
"name" TEXT ,
"description" TEXT ,
"coverFileId" TEXT ,
PRIMARY KEY ("id"))

CREATE TABLE "_ExperimentToProject" (
"A" TEXT NOT NULL,
"B" TEXT NOT NULL,
FOREIGN KEY ("A") REFERENCES "Experiment"("id") ON DELETE CASCADE ON UPDATE CASCADE,

FOREIGN KEY ("B") REFERENCES "Project"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE UNIQUE INDEX "_ExperimentToProject_AB_unique" ON "_ExperimentToProject"("A","B")

CREATE  INDEX "_ExperimentToProject_B_index" ON "_ExperimentToProject"("B")

PRAGMA foreign_key_check;

PRAGMA foreign_keys=ON;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201026123223-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,71 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider        = "sqlite"
+  url = "***"
+  connectionLimit = 2
+}
+
+model Experiment {
+  id          String    @default("unset") @id
+  userEmail   String?
+  name        String    @default("unset")
+  description String?
+  fileId      String    @default("unset")
+  fileName    String?
+  json        String?   @default("{}")
+  User        User?     @relation(fields: [userEmail], references: [email])
+  Result      Result[]
+  Project     Project[]
+  tags        String?
+  coverFileId String?
+}
+
+model User {
+  email      String       @default("unset@monet.com") @id
+  name       String       @default("unset")
+  phone      String?
+  password   String?      @default("unset")
+  level      Int          @default(0)
+  Experiment Experiment[]
+  Project    Project[]
+  Result     Result[]
+}
+
+model Project {
+  id          String       @default("unset") @id
+  description String?
+  agreement   String?
+  public      Int          @default(0)
+  userEmail   String?
+  unitProjectId String?
+  name        String?
+  User        User?        @relation(fields: [userEmail], references: [email])
+  UnitProject UnitProject? @relation(fields: [unitProjectId], references: [id])
+  Result      Result[]
+  Experiment  Experiment[]
+  coverFileId String?
+}
+
+model Result {
+  experimentId String?
+  projectId    String?
+  timestamp    String?
+  id           String      @default("unset") @id
+  done         Int         @default(0)
+  userEmail    String?
+  json         String?     @default("{}")
+  Experiment   Experiment? @relation(fields: [experimentId], references: [id])
+  Project      Project?    @relation(fields: [projectId], references: [id])
+  User         User?       @relation(fields: [userEmail], references: [email])
+}
+
+model UnitProject {
+  id String @default("unset") @id
+  name String?
+  description String?
+  Project Project[]
+  coverFileId String?
+}
```
