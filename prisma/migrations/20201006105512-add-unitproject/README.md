# Migration `20201006105512-add-unitproject`

This migration has been generated by Myeong-Jang Pyeon at 10/6/2020, 7:55:12 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "UnitProject" (
    "id" TEXT NOT NULL DEFAULT 'unset',
    "name" TEXT,
    "description" TEXT,
PRIMARY KEY ("id")
)

PRAGMA foreign_keys=OFF;
CREATE TABLE "new_Project" (
    "id" TEXT NOT NULL DEFAULT 'unset',
    "description" TEXT,
    "agreement" TEXT,
    "public" INTEGER NOT NULL DEFAULT 0,
    "userEmail" TEXT,
    "unitProjectId" TEXT,
    "name" TEXT,
    "coverFileId" TEXT,

    FOREIGN KEY ("userEmail") REFERENCES "User"("email") ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY ("unitProjectId") REFERENCES "UnitProject"("id") ON DELETE SET NULL ON UPDATE CASCADE,
PRIMARY KEY ("id")
);
INSERT INTO "new_Project" ("id", "description", "agreement", "public", "userEmail", "name", "coverFileId") SELECT "id", "description", "agreement", "public", "userEmail", "name", "coverFileId" FROM "Project";
DROP TABLE "Project";
ALTER TABLE "new_Project" RENAME TO "Project";
PRAGMA foreign_key_check;
PRAGMA foreign_keys=ON
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200922113632-..20201006105512-add-unitproject
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider        = "sqlite"
-  url = "***"
+  url = "***"
   connectionLimit = 2
 }
 model Experiment {
@@ -39,10 +39,12 @@
   description String?
   agreement   String?
   public      Int          @default(0)
   userEmail   String?
+  unitProjectId String?
   name        String?
   User        User?        @relation(fields: [userEmail], references: [email])
+  UnitProject UnitProject? @relation(fields: [unitProjectId], references: [id])
   Result      Result[]
   Experiment  Experiment[]
   coverFileId String?
 }
@@ -58,4 +60,11 @@
   Experiment   Experiment? @relation(fields: [experimentId], references: [id])
   Project      Project?    @relation(fields: [projectId], references: [id])
   User         User?       @relation(fields: [userEmail], references: [email])
 }
+
+model UnitProject {
+  id String @default("unset") @id
+  name String?
+  description String?
+  Project Project[]
+}
```
